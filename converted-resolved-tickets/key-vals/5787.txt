zendeskTicketNumber: 5787
zendeskLink: https://sourcegraph.zendesk.com/agent/tickets/5787
title: ServiceTitan - Worker Alerts
Application engineer: Warren Gifford
Customer: ServiceTitan 
Date: Jan 25
Version: â€‹v3.35.0
Deployment: k8s
External Services:
Auth Providers:
Slack Links: https://sourcegraph.slack.com/archives/C02QZQ10JAY/p1643127651047400
GitHub Issue Link: https://github.com/sourcegraph/customer/issues/679
Doc Update Link: https://github.com/sourcegraph/sourcegraph/pull/30709/files
Summary: Customer reporting many alerts in the worker pod for containers OOM -- alerts as well a a bunch of worker-automation-jobs that are OOM
After looking over worker logs gitserver and various other services it was clear this wasn't the result of processes on the worker node. Having a look at the grafana and prometheus yamls we discovered the namespace limiting prometheus config was commented out -- in multitenant kubernetes clusters this needs to be uncommented
uncommented
https://github.com/sourcegraph/deploy-sourcegraph/blob/dax/clarify_prom/base/prometheus/prometheus.ConfigMap.yaml
