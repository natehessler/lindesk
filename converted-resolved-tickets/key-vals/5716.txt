zendeskTicketNumber: 5716
zendeskLink: https://sourcegraph.zendesk.com/agent/tickets/5716
title: Capital One disabled repo and GitHub Enterprise Remote Url Issue
Application engineer: Alex Jean-Baptiste
Customer: Capital One 
Date: Jan 21
Version: â€‹3.22
Deployment: AWS ECS
External Services: GitHub Enterprise
Auth Providers: builtin, github
Slack Links: https://sourcegraph.slack.com/archives/C01QNMSLTFZ/p1642786438007100
GitHub Issue Link: https://github.com/sourcegraph/customer/issues/657
Doc Update Link:
Summary: The customer first experienced a number of repos that would not clone due to the disabled repo state (a GitHub Enterprise exclusive repo state) is not recognized by Sourcegraph and therefore throws repo cloning errors that should not appear.
After separating this issue from the rest of the non-cloning repos the customer experienced repos not cloning that were not disabled. The customer was able to clone the offending repos successfully from a cloud dev environment of Sourcegraph that was added to the GitHub allowed IP address list. After troubleshooting with SWE Ryan Slade and not finding a verifiable root cause issue with Sourcegraph the customer added the offending cloud QA environment of Sourcegraph to the GitHub allowed IP address list and the offending repos cloned successfully.
First issue (disabled repos) 1. gitserver logs were procured. 2. The logs were examined and found to have verbiage describing the repo as "disabled"
Follow up issue 3. Attempts to clone offending repos were performed within the gitserver container 4. Successful clones were made 5. The customer brought to our attention the GitHub allowed IP address list 6. The offending Sourcegraph environment was added to the GitHub allowed IP address list
The offending Sourcegraph environment was added to the GitHub allowed IP address list.
https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/managing-allowed-ip-addresses-for-your-organization
https://stackoverflow.com/questions/23744959/how-to-tell-if-a-repo-is-active-or-disabled-using-the-github-api-v3
2022-02-04 13:35:22t=2022-02-04T19:35:22+0000 lvl=warn msg="error cloning repo" repo=github.cloud.capitalone.com/fmn648/7PS err="error cloning repo: repo github.cloud.capitalone.com/fmn648/7PS not cloneable: exit status 128 (output follows)
