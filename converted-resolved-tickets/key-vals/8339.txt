zendeskTicketNumber: 8339
zendeskLink: https://sourcegraph.zendesk.com/agent/tickets/8339
title: Inconsistent search results + repos not syncing correctly
Application engineer: Gabe Torres
Customer: Vmware 
Date: May 19, 2022
Version: â€‹3.40.0
Deployment: Docker Compose
External Services: Gitlab
Auth Providers: Gitlab
Slack Links: https://sourcegraph.slack.com/archives/C03DYKCM3PD/p1653413483356449
GitHub Issue Link: https://github.com/sourcegraph/customer/issues/975
Doc Update Link:
Summary: The customer's repos were disappearing from the frontend and re-adding the code host connection would temporarily make the repos appear.
We looked at repos for repo updater and gitserver. We checked the database for the total number of repos. We saw a 401 error in the repo updater logs and tied this issue back to the incident with expiring Gitlab Oauth tokens.
This was fixed in the 3.40.1 patch. https://github.com/sourcegraph/sourcegraph/pull/36003
