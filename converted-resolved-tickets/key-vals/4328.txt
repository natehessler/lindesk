zendeskTicketNumber: 4328
zendeskLink: https://sourcegraph.zendesk.com/agent/tickets/4328
title: Structural search on GraphQl returns 0 count
CSE: Mariam Adedeji
Customer: Booking.com 
Date: Oct 29
Version: 3.33.0â€‹
Deployment: docker-compose
External Services: GITLAB
Auth Providers: gitlab
Slack Links: https://sourcegraph.slack.com/archives/C024D1ESXUH/p1635504950043900
GitHub Issue Link: https://github.com/sourcegraph/sourcegraph/pull/26630
Doc Update Link:
Summary: the GraphQL api structural search yielded 0 results despite actual search would have it. Even switching to 'literal' would yield 30 match count.
query { search( patternType: structural query: "file:application-prod.yaml name: java", ) { results { matchCount } } }
Tried reproducing the issue, was unable to recreate it as I could same count as that of UI structural search Suggested adding count:all to the query to the customer, still the same issue Reached out for help on the cs internal channel Reached to the search-support team, they suggested adding timeout:600s to the query, that the search could be timing out on GraphQl, still yielded 0 count We then push forward to using -trace flag with the query using src-cli and the logs came back with errors related to cannot find ref 
Confirmed that this was a known bug with GraphQl structural search panic for missing repo and can be referenced to the fixes on this link
https://github.com/sourcegraph/sourcegraph/blob/main/CHANGELOG.md
![image](https://user-images.githubusercontent.com/32063636/140978713-c3a45f03-2faa-4454-a14e-a54e10b21639.png)
