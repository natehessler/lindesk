zendeskTicketNumber: 7877
zendeskLink: https://sourcegraph.zendesk.com/agent/tickets/7877
title: Stale permission alerts firing in Grafana
Application engineer: Michael Bali
Customer: Citrix 
Date: April 26, 2022
Version: 3.39.1​
Deployment: docker-compose
External Services: BITBUCKETSERVER
Auth Providers: saml
Slack Links: https://sourcegraph.slack.com/archives/CT9P97S6L/p1651038578740999
GitHub Issue Link: https://github.com/sourcegraph/customer/issues/978
Doc Update Link: N/A
Summary: The following alerts were firing in Grafana. - repo-updater: 
-   Tried increasing the API rate limit, but didn't fix it 
-   Tried configuring the 
-   checked the scopes granted on the affected user tokens.The tokens can be found in the 
-   Once we have the token we can check the scopes using this 
    curl -I -H 'Authorization: token TOKEN' https://api.github.com/rate_limit
Then look at the line starting with 
-   In the logs we also noticed SG trying to clone a repo that does not exist both in code host and config file which we felt may be the cause, but restarting the repo updater cleared the error but not the stale permission.
On the call, we noticed they have explicit permission enabled. Which makes all other repository permissions mechanisms are disabled. The admin need to look into the history of why this was configured in the first place. - They either need to enable permissions syncing on their instance or hit the explicit permissions API more often by setting permissions to allow users to view repositories. - If they don't do it often, we'll alert that permissions are out of date - In the repo updater we found Sourcegraph trying to clone a repo that does not exist in the code host or config file. Restarting the repo updater container solved that also.
N/A
-   
-   
-   This error shows that SG tries to update a repo which is not present in the database:
