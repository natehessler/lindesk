-   Application engineer: Stomzy Mwendwa
-   Customer: Criteo 
-   Date: Mar 31
-   Version: 3.38.0
-   Deployment: Kubernetes
-   External Services:
-   Auth Providers:
-   Slack Links: https://sourcegraph.slack.com/archives/CV5KX7T70/p1648736504714249
-   GitHub Issue Link: https://github.com/sourcegraph/customer/issues/813
-   Doc Update Link: N/A
The customer upgraded to v3.38.0 and experienced an issue with syntax highlighting where they received the following error: "http://syntect-server:9238: HSS worker timeout while serving request"
Asked the customer to run some benchmarking to find out the duration highlighting takes by: Locally copy the file that is timing out, say at /path/to/File.json. Clone our syntect repo. git clone https://github.com/sourcegraph/syntect.git && cd syntect. Test highlighting times with two branches: slimsag-main and main. (Showing the steps for slimsag-main below, same steps would apply with main).
git checkout slimsag-main git submodule update --init
cargo build --release --example synhtml
hyperfine './target/release/examples/synhtml /path/to/File.scala'
Also requested for the size of the file which was 1.3M. Quite a large file to highlight, with 24,663 lines of code.
This issue will be fixed by https://github.com/sourcegraph/sourcegraph/issues/33697 and the syntax highlighter migrated from syntect to tree-sitter which will improve highlighting by 3 - 5x for larger files.
