-   Application engineer: Michael Bali
-   Customer: Mercari 
-   Date: Jan 6, 2022
-   Version: 3.35.1â€‹
-   Deployment: kubernetes
-   External Services: GITHUB
-   Auth Providers: openidconnect
-   Slack Links: https://sourcegraph.slack.com/archives/C018U1ZRFQC/p1641535950001100
-   GitHub Issue Link: N/A
-   Doc Update Link: N/A
The customer recently upgraded their Sourcegraph instance to 3.35 but the frontend is now crashing with the error stated in the error section
-   Shared the [documentation](https://docs.sourcegraph.com/admin/how-to/dirty_database) that talks about solving the dirty database issue.
-   The customer first reverted to 3.34.0 as temporary mitigation before retrying the upgrade process again.
-   After running the query in the up migration file, the description of the index returned invalid.
-   I asked that they drop and recreate the index.
    sg=
    DROP INDEX
    sg=
    sg-
    CREATE INDEX
    sg=
-   then you can re-check \
-   The customer can follow through with the remaining instructions in the documentation.
The [documentation](https://docs.sourcegraph.com/admin/how-to/dirty_database) helped resolve the issue.
https://docs.sourcegraph.com/admin/how-to/dirty_database
    t=2022-01-07T06:09:57+0000 lvl=info msg="Checked current version" schema=frontend version=1528395954 dirty=true
    t=2022-01-07T06:09:57+0000 lvl=info msg="Checked current version" schema=frontend version=1528395954 dirty=true
    ERROR: failed to connect to frontend database: dirty database: schema is marked as dirty but no migrator instance appears to be running
    The target schema is marked as dirty and no other migration operation is seen running on this schema. The last migration operation over this schema has failed (or, at least, the migrator instance issuing that migration has died). Please contact support@sourcegraph.com for further assistance.
