-   Application engineer: Giselle Northy
-   Customer: Reddit 
-   Date: Jan 21
-   Version: 3.34.2â€‹
-   Deployment: kubernetes
-   External Services: GITHUB
-   Auth Providers: builtin,github
-   Slack Links: https://sourcegraph.slack.com/archives/C02BJ8T258D/p1642789851051700
-   GitHub Issue Link: https://github.com/sourcegraph/zoekt/pull/244
-   Doc Update Link:
Hi! Running into an issue where running src batch preview is failing due to a renamed repository. 
I did some research and found that this has been recently reported by some other folks. We recently had a regression and an issue has been filed, but not released quite yet.
Essentially when a repository is renamed on the code host, Sourcegraph is not successfully clearing all its data from that repository. It will see the renamed repository as a "new" repo, and then try to maintain both the old copy and the new copy. Then, when batch changes are run, it will give "repo not found" errors on the old version of the repo.
We have a work around in the meantime, which will be to exclude the old name of the repo so it is no longer acting as a redirect from the new -\> old repo which makes it unclone-able.
Please navigate to Site Admin -\> Manage Code Hosts -\> (Select your code host)
In the configuration JSON file, please add the following repo exclusion:
"exclude": [
{
"name": "put/the/old/repo/name/here"
}
],
After a few minutes, Sourcegraph should remove the repo from your instance, and prevent it from being rediscovered which should resolve the issue.
You can confirm this deletion is done by navigating to: Site Admin -\> Repository Status and searching for the repository by name.
If the repository does not appear, then it has been completely removed from your instance, and your batch change should resolve without error.
