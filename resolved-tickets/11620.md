
# Certificate error with OpenID Connect auth provider <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#11620](https://sourcegraph.zendesk.com/agent/tickets/11620)
- Application engineer: Gabe Torres
- Customer: Nuro AI <!-- Redact if this contains personally identifying information -->
- Date: October 11, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.19.1​
- Deployment: docker-container
- External Services: GITHUB
- Auth Providers: openidconnect,builtin


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:
- GitHub Issue Link:
- Doc Update Link:

## Summary
### Description of Customer Issue
Users were unable to log in and were getting the error:   
`Unexpected error refreshing OpenID Connect authentication provider. This may be due to an incorrect issuer URL. Check the logs for more details`

### Troubleshooting Steps
Looked at the frontend logs and saw certificate errors:
`t=2022-10-07T22:05:22+0000 lvl=eror msg="Error prefetching OpenID Connect service provider metadata." error="Get \"https://.../openid-configuration\": x509: certificate signed by unknown authority"`  
`t=2022-10-10T19:34:47+0000 lvl=eror msg="Error refreshing OpenID Connect auth provider." id="{Type:openidconnect ID:tjVdLHOHmCxxOXIMh4tj5w}" error="Get \"https://...openid-configuration\": x509: certificate signed by unknown authority"`  

### Resolution
The customer passed the certificates as a volume, but they removed the env var. Adding them back to fronted, GitHub proxy, and repo updater fixed the issue.

``` 
volumes:
  - 'sourcegraph-frontend-internal-0:/mnt/cache'
  - '/mnt/docker-data/ca-certificates.crt:/etc/ssl/certs/ca-certificates.crt'
```

### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 11620.md -->
