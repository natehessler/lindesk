
# Batch change Preview Hangs <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#9212](https://sourcegraph.zendesk.com/agent/tickets/9212)
- Application engineer: Michael Bali
- Customer: Allegro <!-- Redact if this contains personally identifying information -->
- Date: June 22, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​Kubernetes
- Deployment: 3.40.1
- External Services: GITHUB
- Auth Providers: builtin,github


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C02BF1E7VAN/p1655897179654089
- GitHub Issue Link: N/A
- Doc Update Link: N/A

## Summary
### Description of Customer Issue
When I try to run command `src batch preview` again after the process kill with `control` + `c`, it hangs again on step `Determining workspace type` (second screenshot). The only solution I found is to restart the local device. I also tried other solutions, but unfortunately restarting/killing the docker process etc. doesn’t help.

### Troubleshooting Steps
- First glance I thought this is related to the size or scope of the batch change. SO I told the user to reduce the number of repo this is applied on.
- Then afterward gradually increase these numbers.
- When the number of repositories got to 12 it started to hang again with the error `invalid mount config for type "bind"` .
- 

### Resolution
- For the error:  
    - This seems to be a known docker [issue](https://docs.docker.com/docker-for-mac/release-notes/#docker-desktop-community-301).what version of `docker` and `src-cli` are you using?This breaks src since we use `~/Library/Caches `as the cache directory (which is the default returned by Go's os.UserCacheDir). Disabling experimental gRPC FUSE file sharing in Docker for Mac settings fixed this.
- For the hanging:
- It's probably worth increasing how much RAM is allocated to Docker.
- You could also try running fewer tasks in parallel (at the cost of execution time, of course). You could start with `-j 1` (so it literally runs one at a time), and then slowly ramp back up from there.

### Relevant Docs Pages Used/Created
https://github.com/sourcegraph/customer/issues/1007
### Relevant Error / Logs
`invalid mount config for type "bind"`


<!-- Please redact keys, tokens, and personal identifying information -->
<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 9212.md -->
