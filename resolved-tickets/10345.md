
# Kubernetes Service rerouting traffic <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#10345](https://sourcegraph.zendesk.com/agent/tickets/10345)
- Application engineer: Gabe Torres
- Customer: <!-- Redact if this contains personally identifying information -->
- Date: August 10, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​3.42.0
- Deployment: Kubernetes Helm
- External Services:
- Auth Providers:


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:
- GitHub Issue Link:
- Doc Update Link:

## Summary
### Description of Customer Issue
The customer deployed a new instance with Helm on EKS, and after they set up the ingress and DNS name, they were routed to other services rather than the frontend service. 

### Troubleshooting Steps
The pods for frontend were in a Ready state, so the UI should be working. We tested the pod endpoints ep for sourcegraph-frontend with curl and these directed us to the Sourcegraph login page. Then we tried to curl the frontend service IP at port 30080, which redirected us to a /containers page with a 302 instead of serving the frontend pods. It seems like the issue was with the frontend service and not the ingress, so we kept the original annotations on the ingress resource. We noted that when we recreated the frontend pods, they were in a crashloop possibly due to the database connection errors. We restored the database passwords to the default password and removed the extra labels applied to the pods. When we redeployed the chart, we could get to the sign-in page at your DNS name. So we narrowed down the issue to the extra labels they added or the DB credentials.

### Resolution
The annotations on the ingress were fine, it’s the labels on the pods that were the issue.

### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 10345.md -->
