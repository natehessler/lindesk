

# Segment - usage stats - migration <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#5021](https://sourcegraph.zendesk.com/agent/tickets/5021)

- Application engineer: Warren Gifford

- Customer: Segment.io Inc <!-- Redact if this contains personally identifying information -->

- Date: Dec 10


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.34.2​

- Deployment: kubernetes

- External Services: GITHUB

- Auth Providers: openidconnect





## Links
<!-- Data for application engineer manual entry -->
- Slack Links: [https://sourcegraph.slack.com/archives/CKMSNT9C0/p1639183756077300](https://sourcegraph.slack.com/archives/CKMSNT9C0/p1639183756077300)

- GitHub Issue Link: [https://github.com/sourcegraph/sourcegraph/issues/29338](https://github.com/sourcegraph/sourcegraph/issues/29338) 

- Doc Update Link: [https://github.com/sourcegraph/sourcegraph/pull/29348](https://github.com/sourcegraph/sourcegraph/pull/29348)



## Summary

### Customer Question
This was an inquiry about where usage statistics are stored and how the current site admin usage stats page is generated


### Application Engineer Answer

Usage stats are generated from the Redis DB as well as the event_logs table in the pgsql database. The usage stats page currently uses a deprecated getUsageStatistics package which gatehrs data from the redis db, we should be moving away from this. As such during a standard migration as per our docs, the usage data will be lost (redis isn't backed up)

A separate script used to exist Sourcegraph Server Gen but this script is in need of maintenance and update. It currently doesnt support the codeintel-db

### Relevant Docs Pages Used/Created


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5021.md -->
