
# Sourcegraph tech issues - bitbucket sync and proxy issues <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#5536](https://sourcegraph.zendesk.com/agent/tickets/5536)
- Application engineer: Alex Jean-Baptiste
- Customer: Northrop Grumman <!-- Redact if this contains personally identifying information -->
- Date: Jan 12

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​3.29.1
- Deployment: docker-compose
- External Services: builtin
- Auth Providers: GITLAB


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: Email Thread (https://sourcegraph.zendesk.com/agent/tickets/5536)
- GitHub Issue Link: https://github.com/sourcegraph/customer/issues/639
- Doc Update Link: N/A

## Summary
### Customer Question
The customer initially had connection issues between Sourcegraph and their Bitbucket code host with the following error: "error in syncExternalService for "BITBUCKETSERVER" with ID 3: context deadline exceeded."

The customer's frontend service was also unable to reach out to sourcegraph.com. The customer let it be known that a proxy was in place on their network to reach external servers and that proxy/no_proxy settings were set in their docker configuration.

After a scheduled call the customer also had the following questions:

Is there a way to pull extensions locally so that they can be distributed to an air-gapped environment?

What does Sourcegraph as a whole (network-wise) require to operate in an air-gapped environment successfully?

Is Atlassian Crowd authorization supported?


### Application Engineer Answer

Yes. We have the ability to create a private extensions registry. Here are the docs to do so: https://docs.sourcegraph.com/admin/extensions#publish-extensions-to-a-private-extension-registry

The answer is that Sourcegraph is perfectly suitable to work in an air-gapped environment. You should however keep the following in mind when operating Sourcegraph  in that manner:

Any code host that you are using should also be available on the air-gapped instance as well. 

As it currently stands, Sourcegraph does not support Atlassian Crowd.

Atlassian Crowd has SAML authentication for SSO available as described in the docs here if your team has access to Crowd Data Center.

The tool you are using to manage your LDAP connections (i.e., Microsoft AD, Okta, etc.) may be configured to use SAML authentication.  
 
In which case, the above docs should work as well.

### Relevant Docs Pages Used/Created

https://docs.sourcegraph.com/admin/auth/saml/generic
https://docs.sourcegraph.com/admin/auth/saml
https://docs.sourcegraph.com/admin/config/site_config#saml
https://docs.sourcegraph.com/admin/extensions#publish-extensions-to-a-private-extension-registry

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5536.md -->
