

# Reddit Batch Changes Pending After 24Hours/Database Error <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#4234](https://sourcegraph.zendesk.com/agent/tickets/4234)

- CSE: Alex Jean-Baptiste

- Customer: Reddit <!-- Redact if this contains personally identifying information -->


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.33.0​

- Deployment: kubernetes

- External Services: GITHUB

- Auth Providers: builtin,guithub





## Links
<!-- Data for CSE manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C02BJ8T258D/p1635450874063500

- GitHub Issue Link: N/A

- Doc Update Link: N/A



## Summary

### Description of Customer Issue

The customer reported a set of batch changes remained in the pending state after 24hours. One of the batch changes was stuck in a retrying state due to a database error.



### Troubleshooting Steps

dbworker ruled out of causing issues due to the fact that a "retrying" batch changes state indicates an error at the database layer
Reconciler thought to be the source of root cause
The customer upgraded to Sourcegraph v. 3.33 and the issue was resolved
Reconciler package was not committed to between 3.32.0 and 3.33.0
Static analysis with grep and Sourcegraph was done but no bug was found to indicate a transaction was closed early or a bug in the error handling is present 



### Resolution

An upgrade to Sourcegraph v. 3.33.0 resolved the issue. The root cause was still unknown.



### Relevant Error / Logs

<!-- Please redact keys, tokens, and personal identifying information -->

Failed to run operations on changeset

Sql: transaction has already been committed or rolled back


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4234.md -->
