
# Monorepos corruption <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#10881](https://sourcegraph.zendesk.com/agent/tickets/10881)
- Application engineer: Michael Bali
- Customer: Mercari <!-- Redact if this contains personally identifying information -->
- Date: August 31, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.37.0​
- Deployment: kubernetes
- External Services: GITHUB
- Auth Providers: openidconnect


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/D03TEAYPWAW/p1662025329562089?thread_ts=1662025087.252239&cid=D03TEAYPWAW
- GitHub Issue Link: N/A
- Doc Update Link: N/A

## Summary
### Description of Customer Issue
Two of our larger repos had a problem indexing and now it seems nothing I do causes it to be successfully reindexed.

```
...
Resolving deltas: 100% (26232/26232), completed with 1293 local objects
fatal: bad object bc6b92aee05cdf956742b218edbeac26b3a59b57
error: https://github.com/kouzoh/xyz did not send all necessary objects

": exit status 1 
```
### Troubleshooting Steps

- The error you shared is related to a "[bad](https://docs.sourcegraph.com/admin/how-to/repo-not-updated#what-is-a-bad-repository)" /corrupted repo getting cloned.

- Can you exec into the gitserver directory for this repos and run `git prune` and `git fetch` ?

- `git gc` shows the error
```
$ git prune
fatal: unable to parse object: refs/pull/50406/head
$ git gc
error: refs/pull/50406/head does not point to a valid object!
fatal: bad object refs/pull/50406/head
fatal: failed to run repack
```


### Resolution

To fix this we need to remove and reclone the repo. This [document](https://docs.sourcegraph.com/admin/how-to/remove-repo#remove-corrupted-repository-data-from-sourcegraph) will walk you through the steps of removing a repository from Sourcegraph and recloning the removed repository .



### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->

- `git gc` shows the error


$ git prune
fatal: unable to parse object: refs/pull/50406/head
$ git gc
error: refs/pull/50406/head does not point to a valid object!
fatal: bad object refs/pull/50406/head
fatal: failed to run repack


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 10881.md -->
