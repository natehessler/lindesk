
# Recurring Monorepo corruption <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#11204](https://sourcegraph.zendesk.com/agent/tickets/11204)
- Application engineer: Michael Bali
- Customer: Lyft, Inc. <!-- Redact if this contains personally identifying information -->
- Date: September 26, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.36.3​
- Deployment: kubernetes
- External Services: GITHUB
- Auth Providers: saml


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C0174NVAREV/p1664216628631559
- GitHub Issue Link: N/A
- Doc Update Link: N/A

## Summary
### Description of Customer Issue
the repo-updater component has been unable to fetch one our big repositories for the past 6 days. there’s a `fatal: bad object 20xxxx` log in the repo-updater logs, as well as `did not send all necessary objects` wondering what’s the best way to get the repository unstuck.

### Troubleshooting Steps
This is a known issue
### Resolution
I understand that this is a reoccuring theme and there is a temporary mitigation which you have been applying so far.
This is related to `SG_MAINTENANCE` and `git gc` garbage collector job running in parallel. This causes repo corruption to happen frequently when both of them are on.
Next steps for you, You can reclone and we advise that the following env vars be set in `gitserver` sts manifest. Restart gitserver with the environment variable set in the manifest
by adding the below `env` variable in the spec section
```
- name: ENABLE_GC_AUTO
      value: "true"
    - name: SRC_ENABLE_SG_MAINTENANCE
      value: "false"
```

### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 11204.md -->
