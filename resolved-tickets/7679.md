
# The worker: codeintel_commit_graph_queued_max_age keeps firing alerts. <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#7679](https://sourcegraph.zendesk.com/agent/tickets/7679)
- Application engineer: Michael Bali
- Customer: Reddit <!-- Redact if this contains personally identifying information -->
- Date: Apr 15

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.36.2​
- Deployment: kubernetes
- External Services: GITHUB
- Auth Providers: builtin,github


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C02BJ8T258D/p1650038229844779
- GitHub Issue Link: N/A
- Doc Update Link: N/A

## Summary
### Description of Customer Issue
I understand that the `worker: codeintel_commit_graph_queued_max_age` keeps firing alerts.

### Troubleshooting Steps
- From the docs, This is indicative of  either underprovisioned worker instance(s) and/or an underprovisioned main postgres instance.
- I requested for screenshots of the following related dashboard:`https://<sourcegraph-instance-url/-/debug/grafana/d/worker/worker?orgId=1&viewPanel=100102` I would like to understand the metrics there.
- In addition, can I get logs from the worker, postgrs and gitserver to help investigate deeper.

 I looked at logs from the worker found the following errors:
- I see alot of `Failed to determine queued duration" error="sql: Scan error on column index 0, name \"age\": converting NULL to int is unsupported `I understand this can be ignored. It has been fixed [here](https://github.com/sourcegraph/sourcegraph/pull/32970) and will be in the next update.

- I didn't see any  OOM error or anything to indicate that the worker is under-provisioned on this container to warrant increasing the memory.

Nothing in the logs is confirming that the worker in under-provisioned. My suspicion here is this alerts is firing because of the noisy (but harmless) error messages in v3.38.0.

Just some follow up questions;
- the alert only fired once in the span of an hour (1900-2000hrs) all through yesterday and resolved itself?

- Also, I want to verify if this happened when  a bunch of new code hosts/repos added to Sourcegraph?

### Resolution
My suspicion here is this alerts is firing because of the noisy (but harmless) error messages in v3.38.0, Considering this resolves itself almost immediately. As a mitigation step, can you silence the alert pending an upgrade to the latest v3.39.

### Relevant Docs Pages Used/Created
- https://docs.sourcegraph.com/@main/admin/observability/alert_solutions#precise-code-intel-worker-codeintel-upload-queued-max-age%22critical_precise-code-intel-worker_codeintel_upload_queued_max_age

- https://github.com/sourcegraph/sourcegraph/pull/32970

### Relevant Error / Logs
`Failed to determine queued duration" error="sql: Scan error on column index 0, name \"age\": converting NULL to int is unsupported `

<!-- Please redact keys, tokens, and personal identifying information -->


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 7679.md -->
