
# Batch Change error <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#6903](https://sourcegraph.zendesk.com/agent/tickets/6903)
- Application engineer: Gabe Torres
- Customer: Netflix <!-- Redact if this contains personally identifying information -->
- Date: Mar 15

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.37.0​
- Deployment: pure-docker
- External Services: BITBUCKETSERVER
- Auth Providers: http-header


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C01UR6C9K3R/p1647310521340519 
- GitHub Issue Link:
- Doc Update Link:

## Summary
### Description of Customer Issue
The customer was getting an error with a particular batch change. They were able to create other batch changes.

### Troubleshooting Steps
I looked at the batch spec and everything seemed fine. The fact that the customer was able to create other batch changes seemed to indicate there was an error with the repos in this batch change.

### Resolution
I looked at the gitserver logs and found an error with a repo being used in the batch change. The repo seemed to be corrupt with the message 'got bad commit'. Excluding this repo from the batch change should work.

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->
```
❌ Error:
   resolving repositories: resolving "(repo:org/name) file:.gitignore not .metatron": GraphQL errors: 2 errors occurred:
    * {
     "message": "GetObject \"http://gitserver/commands/get-object\": GetObject: http status 500 getting object",
     "path": [
       "search",
       "results",
       "results",
       3,
       "repository",
       "defaultBranch",
       "target",
       "oid"
     ]
   }
```
`t=2022-03-16T19:25:44+0000 lvl=eror msg="handleGetObject: getting object" error="ResolveRevision: got bad commit \"warning: refname 'refs/heads/master' is ambiguous.\\hash\" for repo \"instance.com/org/repo-name\" at revision \"refs/heads/master\"`"


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 6903.md -->
