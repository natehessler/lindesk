# Structural search on GraphQl returns 0 count 



- Zendesk Link: [#4328](https://sourcegraph.zendesk.com/agent/tickets/4328)

- CSE: Mariam Adedeji

- Customer: Booking.com <!-- Redact if this contains personally identifying information -->

- Date: Oct 29


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.33.0â€‹

- Deployment: docker-compose

- External Services: GITLAB

- Auth Providers: gitlab





## Links
<!-- Data for CSE manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C024D1ESXUH/p1635504950043900

- GitHub Issue Link: https://github.com/sourcegraph/sourcegraph/pull/26630

- Doc Update Link:



## Summary

### Description of Customer Issue

the GraphQL api structural search yielded 0 results despite actual search would have it. Even switching to 'literal' would yield 30 match count.



query {
  search(
    patternType: structural
    query: "file:application-prod.yaml name: java",
  ) {
    results {
      matchCount
    }
  }
}





### Troubleshooting Steps

Tried reproducing the issue, was unable to recreate it as I could same count as that of UI structural search
Suggested adding count:all to the query to the customer, still the same issue 
Reached out for help on the cs internal channel
Reached to the search-support team, they suggested adding timeout:600s to the query, that the search could be timing out on GraphQl, still yielded 0 count
We then push forward to using -trace flag with the query using src-cli and the logs came back with errors related to cannot find ref <repo>@HEAD and not a git repo 



### Resolution

Confirmed that this was a known bug with GraphQl structural search panic for missing repo and can be referenced to the fixes on this link



### Relevant Docs Pages Used/Created

https://github.com/sourcegraph/sourcegraph/blob/main/CHANGELOG.md



### Relevant Error / Logs

<!-- Please redact keys, tokens, and personal identifying information -->

![image](https://user-images.githubusercontent.com/32063636/140978713-c3a45f03-2faa-4454-a14e-a54e10b21639.png)
