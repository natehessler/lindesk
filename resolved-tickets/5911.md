
# Password recovery without smtp in config <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#5911](https://sourcegraph.zendesk.com/agent/tickets/5911)
- Application engineer: Jason Harris
- Customer: Mercury <!-- Redact if this contains personally identifying information -->
- Date: Jan 31

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​3.24
- Deployment: docker-compose
- External Services: 
- Auth Providers:


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: n/a
- GitHub Issue Link: n/a
- Doc Update Link: n/a

## Summary
### Description of Customer Issue
Customer attempted to upgrade from 3.24 all the way to 3.36 in one fell swoop. This led to every error one may expect, most dirty database errors, but also complete failures to migrate the db all together. I informed the customer that they would need to revert back to 3.24, and upgrade sequentially. However, they were unable to remember their password. This became the main issue.

### Troubleshooting Steps
Security check. Passed that.
Asked them to use the recovery option. They had never set that up, so they couldn't.
Asked them to set up smtp email to use recovery option by updating the site-config via SSH (they still had SSH access). They were resistant to this because they didn't want to standup an smtp server.
I set up my own instance on an EC2, just as they did, and attempted to manually change the password hash for the user be creating a new hash and updating the table. This worked for me because I didn't have a URL configured. However, they did, and so it did not work for them.


### Resolution
After trying every possible means of recovering or changing their password, I informed the customer (using free open source) that it would be best if they simply spun up a new instance, and started over. They were very open to this, as they just wanted to get back to work. In the future, I'm not sure there is a workaround for this.

### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5911.md -->
