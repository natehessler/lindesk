​
# What data to persist... <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#9671](https://sourcegraph.zendesk.com/agent/tickets/9671)
- Application engineer: Alex Jean-Baptiste
- Customer: GOV.UK <!-- Redact if this contains personally identifying information -->
- Date: July 12, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.37.0​
- Deployment: kubernetes
- External Services:
- Auth Providers:


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: Email
- GitHub Issue Link: N/A
- Doc Update Link: N/A

## Summary
### Customer Question
​
​What I need to know is, which volumes do I need to persist outside of docker so when I restart I don’t lose anything?

I’ve got my RDS externalised and my config is now mapped into the docker-compose.yaml via SITE_CONFIG_FILE, EXTSVC_CONFIG_FILE and GLOBAL_SETTINGS_FILE env variables, but I haven’t persisted any filesystems.

Which filesystems do I need (if any!) to persist – or is everything stored in the 3 databases?
​
////////////////////////////////////////////////CUSTOMER QUESTION CONTINUED//////////////////////////////////////
​
It’s a terraform project that builds an asg/rds/r53/s3 that the docker-compose instance of Sourcegraph will sit on.  The config for Sourcegraph is manged via terraform substituting variables into the json files and putting them on the server before starting. The databases are externalised to RDS.
​
Environment variables are used to substitute and take into account dev/test/prod environments so I can build/test and deploy as needed.
​
I need to account for the server being restarted now, without losing any reports or data.

### Application Engineer Answer
​
​Thank you for giving me some more context on what you are trying to accomplish.

The volumes you should persist outside of Docker when restarting the instance are the following:


caddy (For keeping your Caddy configuration)
gitserver-0 (For keeping the bare clones of your repos that Sourcegraph relies on for core functionality, if not kept repos will have to be re-cloned)
grafana (For keeping your Grafana dashboards)
minio (For keeping your LSIF uploads)
prometheus-v2 (For keeping your metric data that is eventually piped to Grafana for display)
zoekt-0-shared (For keeping the indices generated for trigram-based code search, if not kept repos will have to be re-indexed)


These volumes are necessary for core functionality in Sourcegraph and the data is not persisted in the database.

Keeping the data from these volumes and your databases should be all that you need to maintain the core functionality of your Sourcegraph instance on a deployment restart.

The rest of the volumes in docker-compose.yml are for short-lived data such as caching user sessions.

### Relevant Docs Pages Used/Created

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 9671.md -->
