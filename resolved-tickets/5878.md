
# segment - investigate SAML sign-in admin aware <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#5878](https://sourcegraph.zendesk.com/agent/tickets/5878)
- Application engineer: Warren Gifford
- Customer: Segment.io Inc <!-- Redact if this contains personally identifying information -->
- Date: Jan 28

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.34.2​
- Deployment: kubernetes
- External Services: GITHUB
- Auth Providers: openidconnect


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:
- GitHub Issue Link:
- Doc Update Link:

## Summary
### Customer Question
Is there a way to configure SAML response to inform Sourcegraph of who is/isn't an Admin? Otherwise, is there a way to force make someone an Admin via a manual Postgres query?

Also, while you're at it, is there a way to generate site-admin:sudo tokens that aren't associated to a specific user?

### Application Engineer Answer

Hey @ajacobs I had a chance to do some looking into both configuring SAML login to register a user as a site admin, and I'm afraid I'm going to be the bearer of bad newsFor Okta SAML login it looks like from the Okta side this should be possible, but Sourcegraph isn't yet able to process this sort of setupAs for generating a Sourcegraph access token that isn't associated to a user account I'm afraid thats not possible at the moment either, you can see from our database that the creator_user_id and subject_user_id fields are required on a token
sg=# \d access_tokens
                                         Table "public.access_tokens"
     Column      |           Type           | Collation | Nullable |                  Default
-----------------+--------------------------+-----------+----------+-------------------------------------------
 id              | bigint                   |           | not null | nextval('access_tokens_id_seq'::regclass)
 subject_user_id | integer                  |           | not null |
 value_sha256    | bytea                    |           | not null |
 note            | text                     |           | not null |
 created_at      | timestamp with time zone |           | not null | now()
 last_used_at    | timestamp with time zone |           |          |
 deleted_at      | timestamp with time zone |           |          |
 creator_user_id | integer                  |           | not null |
 scopes          | text[]                   |           | not null |
 internal        | boolean                  |           |          | false
Indexes:
    "access_tokens_pkey" PRIMARY KEY, btree (id)
    "access_tokens_value_sha256_key" UNIQUE CONSTRAINT, btree (value_sha256)
    "access_tokens_lookup" hash (value_sha256) WHERE deleted_at IS NULL
Foreign-key constraints:
    "access_tokens_creator_user_id_fkey" FOREIGN KEY (creator_user_id) REFERENCES users(id)
    "access_tokens_subject_user_id_fkey" FOREIGN KEY (subject_user_id) REFERENCES users(id)
Referenced by:
    TABLE "batch_spec_workspace_execution_jobs" CONSTRAINT "batch_spec_workspace_execution_jobs_access_token_id_fkey" FOREIGN KEY (access_token_id) REFERENCES access_tokens(id) ON DELETE SET NULL DEFERRABLE

Going to flag in @rami to help get a feature request going around this

### Relevant Docs Pages Used/Created

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5878.md -->
