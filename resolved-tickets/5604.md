
# LSIF failing to process <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#5604](https://sourcegraph.zendesk.com/agent/tickets/5604)
- Application engineer: Warren Gifford
- Customer: Twitter <!-- Redact if this contains personally identifying information -->
- Date: Jan 14

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.35.1​
- Deployment: kubernetes
- External Services:
- Auth Providers:


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:
- GitHub Issue Link: [https://github.com/sourcegraph/customer/issues/649](https://github.com/sourcegraph/customer/issues/649)
- Doc Update Link:

## Summary
### Description of Customer Issue

Since v 3.34.x Twitters CI lsif pipeline started to fail uploading dump.lsif files for their monorepo `source` -- investigation of this was initially waylaid as we discovered that the index-server wasn't indexing source and that was a higher priority. 

### Troubleshooting Steps

Provide more resources to the precise-code-intl-worker. Look at the precise-code-intel-worker logs -- observed database connection errors -- if a database connection is dropped during the upload processing this failure isn't graceful and the upload will fail and require a restart.

### Resolution

Provision more resources to the pgsql database -- this wasnt a tuning of the `posgresql.conf` but instead just a raw resource dump. 

### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->
```log
Upload failed to complete: Gitserver.DefaultBranchContains: BranchesContaining: gitserver.Command: signal: killed
```

```log
t=2022-01-24T10:51:35+0000 lvl=eror msg=workerutil.dbworker.store.codeintel_upload.Dequeue error="failed to connect to `host=10.138.2.65 user=sg database=frontend-db`: server error (FATAL: the database system is in recovery mode (SQLSTATE 57P03))" count=1.000 elapsed=0.558
t=2022-01-24T10:51:35+0000 lvl=eror msg="Failed to dequeue and handle record" name=precise_code_intel_upload_worker err="store.Dequeue: failed to connect to `host=10.138.2.65 user=sg database=frontend-db`: server error (FATAL: the database system is in recovery mode (SQLSTATE 57P03))"
```

```log
Upload failed to complete: Job processor died while handling this message too many times
```


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5604.md -->
