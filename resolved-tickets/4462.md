

# Reddit: can `src-cli` return a full list of all repos/repositories via query? <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#4462](https://sourcegraph.zendesk.com/agent/tickets/4462)

- CSE: Kelvin Lee

- Customer: Reddit <!-- Redact if this contains personally identifying information -->

- Date: Nov 5


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.32.0​

- Deployment: kubernetes

- External Services: GITHUB

- Auth Providers: builtin,guithub





## Links
<!-- Data for CSE manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C02BJ8T258D/p1636151760098600

- GitHub Issue Link: None

- Doc Update Link: None



## Summary

Client wants to use `src-cli` to run a query. Specifically, the query is to output the entire list of repositories/repos attached to the Sourcegraph instance, and write the output to a file/`.json`

The client's initial query would not output the entire list of results, due to result count limits enforced by Sourcegraph. Client raised this as a question to see if they can get an exhaustive list.

Application engineer initially was not able to find a workaround, but from help from Ben Gordon via DMs, a new query was written which allowed for the exhaustive return of all results.



### Customer Question

"Is there a way to get the CLI to stream all results?"

With more detail/context, is there a way to get `src cli` to return all results of a query for a list of repositories, then write that to a `.json` ?


### CSE Answer
Yes! The query that the client had used was just malformed. Instead of using:

```
src search --stream --json select:repo fork:yes archived:yes | tee /tmp/repos.json
```

... Use this instead...:

```
src search --stream --json "select:repo fork:yes archived:yes count:all" | tee /tmp/repos.json
```

Note, in particular, the " that enclose the query.

Note, also that the  `| tee /tmp/repos.json` simply write the output of the search to a file located in the `/tmp` folder, and writes it to the file called `repos.json`. This second half is not necessary for the query.


### Relevant Docs Pages Used/Created

None

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4462.md -->
