

# New Slack message in support-criteo <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#4626](https://sourcegraph.zendesk.com/agent/tickets/4626)

- Application engineer: Stomzy Mwendwa

- Customer: Criteo <!-- Redact if this contains personally identifying information -->

- Date: Nov 17


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: ​3.30.1

- Deployment: Kubernetes

- External Services: 

- Auth Providers: GitHub





## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/CV5KX7T70/p1637231583005400

- GitHub Issue Link:

- Doc Update Link:



## Summary

### Customer Question

Hello team, I have an issue using the api (https://codesearch.criteois.com/.api/graphql)
I post the following query to retrieve all files in a repo:

{'query': 'query ListFiles($repoName: String!) {repository(name: $repoName) {    commit(rev: "HEAD") {tree(path: "", recursive: true) {        entries {          path          isDirectory          url        }      }    }  }}',
 'variables': {'repoName': 'vault/configuration'},
 'operationName': 'ListFiles'}

Same query as in the example provided
But it gives: '{"data":{"repository":null}}'
Am I doing something wrong?But it works when I do: https://codesearch.criteois.com/search?q=repo:vault/configuration
### Application Engineer Answer

Hey @f.gaignier
Could you please try this?

query ListFiles($repoName: String!) {
  repository(name: $repoName) {
    commit(rev: "HEAD") {
      tree(path: "", recursive: true) {
        entries {
          path
          isDirectory
          url
        }
      }
    }
  }
}

### Relevant Docs Pages Used/Created

https://sourcegraph.com/api/console?_ga=2.139893691.943294706.1636981475-1756623820.1624359677#%7B%22query%22%3A%22query%20ListFiles(%24repoName%3A%20String!)%20%7B%5Cn%20%20repository(name%3A%20%24repoName)%20%7B%5Cn%20%20%20%20commit(rev%3A%20%5C%22HEAD%5C%22)%20%7B%5Cn%20%20%20%20%20%20tree(path%3A%20%5C%22%5C%22%2C%20recursive%3A%20true)%20%7B%5Cn%20%20%20%20%20%20%20%20entries%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20path%5Cn%20%20%20%20%20%20%20%20%20%20isDirectory%5Cn%20%20%20%20%20%20%20%20%20%20url%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%7D%5Cn%22%2C%22variables%22%3A%22%7B%5C%22repoName%5C%22%3A%20%5C%22github.com%2Fgorilla%2Fmux%5C%22%7D%22%2C%22operationName%22%3A%22ListFiles%22%7D
<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4626.md -->
