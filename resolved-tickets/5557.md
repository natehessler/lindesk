# New Slack message in support-citrix <!-- Ticket Title  Hint: include keywords to make it searchable -->
 
- Zendesk Link: [#5557](https://sourcegraph.zendesk.com/agent/tickets/5557)
- Application engineer: Stomzy Mwendwa
- Customer: Citrix <!-- Redact if this contains personally identifying information -->
- Date: Jan 13

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->
 
## Technical Environment
- Version: 3.35.1â€‹
- Deployment: docker-compose
- External Services: BITBUCKETSERVER
- Auth Providers: saml
 
 
## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/CT9P97S6L/p1642075424000700
- GitHub Issue Link:
- Doc Update Link:
 
## Summary
### Customer Question
The customer would like to know if there is an ability to create a token for a user using the GraphQL API. 
mutation {
  createAccessToken(204: ID!) {
    user: 204, 
    scopes: "site-admin:sudo", 
    note: "Sourcegraph License Cleanup - secretid: 28205"
  }
} 
 
### Application Engineer Answer
We tried the following query:
mutation CreateAccessToken($user: ID, $scopes: [String!]!, $note: String!) {
  createAccessToken(user: 204, scopes: "site-admin:sudo", note: "Sourcegraph License Cleanup") {
    token
    id
  }
}
 
Upon further investigation, based on: https://sourcegraph.com/github.com/sourcegraph/sourcegraph/-/blob/cmd/frontend/graphqlbackend/access_tokens.go?L40-47
this was disabled to prevent site admins from accessing users private code.

The workaround with this I offered to enable builtin auth, setup credentials as an admin for the service account and log in as the service account and generate the token.
 
### Relevant Docs Pages Used/Created
https://sourcegraph.com/github.com/sourcegraph/sourcegraph/-/blob/cmd/frontend/graphqlbackend/access_tokens.go?L40-47

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5557.md -->
