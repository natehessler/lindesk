
# GraphQL API error when running batch change <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#9754](https://sourcegraph.zendesk.com/agent/tickets/9754)
- Application engineer: Michael Bali
- Customer: Imburse <!-- Redact if this contains personally identifying information -->
- Date: July 14, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​N/A
- Deployment: N/A
- External Services: N/A
- Auth Providers: N/A


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:  https://sourcegraph.slack.com/archives/C03MS1Q7MGQ/p1657877437187439
- GitHub Issue Link:  https://github.com/sourcegraph/sourcegraph/issues/15892
- Doc Update Link: N/A

## Summary
### Description of Customer Issue

Hi, So I am trying to test "large" batch changes and I am consistently running into this error:
`Failed to run operations on changeset`
`Creating draft changeset: error in GraphQL response: was submitted too quickly`
This seems to lock my account from creating any PRs, as I now get this error when creating PRs without using Sourcegraph. I can see an open issue that says this is expected: https://github.com/sourcegraph/sourcegraph/issues/15892
Is there any way to fix/work around this so the PRs are created slower so I don't end up in a stuck state?

### Troubleshooting Steps
- I would like to confirm, if the error fails to move into the “Retrying” state are they marked as failed?
- So it will retry and most will succeed. I just trialed a batch of 40 PRs. The first 30 retried and worked. The final 10 went into a failed state. And after an hour were still in the failed state. I had to manually click retry on each one to get them to create the PRs. I had to wait about an hour for GitHub to release the block on my account to allow me to create PRs again.
- It feels like a rate limit block on the GitHub side, rather than an issue in Sourcegraph directly.

### Resolution
Yes, your interpretation of the error you see is correct. A workaround you can try is to configure batch changes rollout windows to help schedule changesets. Sharing a [doc](https://docs.sourcegraph.com/admin/config/batch_changes#batch-changes-site-admin-configuration-reference) on how we can do that. It's super easy to configure as an admin and you can have that set up pretty fast.
### Relevant Docs Pages Used/Created
https://docs.sourcegraph.com/admin/config/batch_changes#batch-changes-site-admin-configuration-reference
### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 9754.md -->
