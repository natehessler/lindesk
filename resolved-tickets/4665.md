

# Dropbox -Alerts Queries <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#4665](https://sourcegraph.zendesk.com/agent/tickets/4665)

- Application engineer: Warren Gifford

- Customer: Dropbox <!-- Redact if this contains personally identifying information -->

- Date: Nov 19


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.33.2​

- Deployment: docker-compose

- External Services: OTHER

- Auth Providers: saml





## Links
<!-- Data for application engineer manual entry -->
- Slack Links:

- GitHub Issue Link:

- Doc Update Link:



## Summary

### Description of Customer Issue

Customer experiencing alerts 


Multiple inquires are logged in this ticket:


are any of the worker jobs resource-intensive?
somehow these are the only alerts that are firing since we deployed 3.30.4 (maybe explain this), alerts below

symbols: 25+ current fetch queue size
zoekt-webserver: 5% Indexed search request errors every 5m by code for 5m0s
frontend: 20s+ 99th percentile code-intel successful search request duration over 5m
frontend: 15s+ 90th percentile code-intel successful search request duration over 5m
wondering if we should just double gitserver instead.

 
Info:


workers seem to be at like 1% CPU/mem.
gitserver also seems to run at <20% CPU/mem most of the time so not sure if that really helps (maybe it can’t vertically scale anymore, already at 20cpus 48gb)




### Troubleshooting Steps



check grafana provisioning indicators
observe logs after adding "observability.logSlowSearches": 20, in site config json to determine consistency of long code-intel searches



### Resolution



This issue is unresolved until symbols is improved with major overhaul due in v3.35



As temporary solution adding a second well-provisioned gitserver



### Relevant Docs Pages Used/Created



[https://docs.sourcegraph.com/admin/observability/alert_solutions](https://docs.sourcegraph.com/admin/observability/alert_solutions)

[https://docs.sourcegraph.com/admin/how-to/monorepo-issues](https://docs.sourcegraph.com/admin/how-to/monorepo-issues)

[https://github.com/sourcegraph/sourcegraph/pull/27986](https://github.com/sourcegraph/sourcegraph/pull/27986)



### Relevant Error / Logs

<!-- Please redact keys, tokens, and personal identifying information -->
```

ESC[32;1msourcegraph-frontend-2           |ESC[0m t=2021-11-24T00:49:20+0000 lvl=warn msg="slow search request" actor_internal=false actor_uid=7746 alert_type=timed_out duration_ms=20000 query="context:global ^TrayAccountSwitcherAdapter$ type:symbol patternType:regexp case:yes file:\\.(ts|tsx|js|jsx)$ repo:^server$@1a7c453f9cfb07f71b67bbb9078699158dfd203b" result_size=0 source=browser status=alert type=CodeIntelSearch
ESC[32;1msourcegraph-frontend-2           |ESC[0m t=2021-11-24T00:49:21+0000 lvl=warn msg="slow search request" actor_internal=false actor_uid=338 alert_type=timed_out duration_ms=20001 query="context:global ^_build_charge_order_request$ type:symbol patternType:regexp case:yes file:\\.(py)$ repo:^server$@e9783676d28d18893cd56e26e1d6f99c2aed739c" result_size=0 source=browser status=alert type=CodeIntelSearch

```


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4665.md -->
