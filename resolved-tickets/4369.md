

# How to get Information on OOMKill and Pod Restarts with the default Prometheus in Grafana.
 <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#4369](https://sourcegraph.zendesk.com/agent/tickets/4369)

- CSE: Michael Bali

- Customer: Tableau <!-- Redact if this contains personally identifying information -->


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.18.0​

- Deployment: docker-compose

- External Services: OTHER,GITLAB

- Auth Providers: builtin,saml





## Links
<!-- Data for CSE manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C011899KB6U/p1635551319008600

- GitHub Issue Link: N/A

- Doc Update Link: N/A



## Summary

###Customer Question

- Q1. Hello Sourcegraph! Another monitoring and integration question for you: We want to start monitoring pod restarts and OOM terminations so we can watch out for underlying issues in our server. I see there are some pod-level metrics exposed in grafana on a per-service basis, but it looks to be purely percentage-based. Is there a way we can get information on OOMKill and pod restarts with the default Prometheus, or will we need to use something like https://github.com/kubernetes/kube-state-metrics to do it for us? Thanks!

- Q2. I couldn't find a metric for pod restart counts on that page, did I miss something?


### CSE Answer


- Prometheus sends all metrics to Grafana. So certain thresholds, whenever they get exceeded, alerts are sent to Grafana and that's how the dashboard gets populated.Grafana will just show the message but a docker inspect -f '{{json .State}}' $container would give more information also logs.


- There isn't a direct metric to get pod restart counts. However, On Grafana you go to the specific pod, click on Kubernetes monitoring to get the Percentage pods available. While on Docker-Compose you click on the Container's container missing metric.You can also get this using the commands
k8: kubectl get pods
DC:

docker events --filter event=restart --since=60m

### Relevant Docs Pages Used/Created

https://docs.sourcegraph.com/admin/observability/dashboards#frontend-pods-available-percentage

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4369.md -->
