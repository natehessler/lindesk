

# Codeinsights-db corruption <!-- Ticket Title  Hint: include keywords to make it searchable -->



- Zendesk Link: [#4431](https://sourcegraph.zendesk.com/agent/tickets/4431)

- CSE: Ben Gordon

- Customer: Reddit <!-- Redact if this contains personally identifying information -->

- Date: Nov 4


<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->

<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->



## Technical Environment

- Version: 3.32.0​

- Deployment: kubernetes

- External Services: GITHUB

- Auth Providers: builtin,guithub





## Links
<!-- Data for CSE manual entry -->
- Slack Links: 

    - [Engineering help thread](https://sourcegraph.slack.com/archives/C014ZCKMCAV/p1636045934174500)

    - [Customer help thread](https://sourcegraph.slack.com/archives/C02BJ8T258D/p1636042132091300)

- GitHub Issue Link: 

    - [https://github.com/sourcegraph/customer/issues/551](https://github.com/sourcegraph/customer/issues/551)

- Doc Update Link: 

    - N/A



## Summary

### Customer Question

How to rebuild codeinsights-db after accidental deletion



### CSE Answer

- Rebuild the codeinsights-db
- Restart frontend and let it perform all migrations on the codeinsights-db
- Restart worker service / pod and code insights should start up at that point
- Restart frontend again one more time to be safe



### Relevant Docs Pages Used/Created

N/A -- a doc would make sense here normally, but engineering is about to change the behavior of codeinsights-db in a way that makes rebuilding it impossible, so this doc would be out-of-date before anybody has a chance to use it


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4431.md -->
