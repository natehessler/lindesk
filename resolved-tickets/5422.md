
# repositoriesMatchingQuery isn’t returning the same amount of repos as the same query in code search and 403 from my code host when creating drafts <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#5422](https://sourcegraph.zendesk.com/agent/tickets/5422)
- Application engineer: Michael Bali
- Customer: Rapha <!-- Redact if this contains personally identifying information -->
- Date: Jan 6, 2021

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​3.34.1
- Deployment: N/A
- External Services: N/A
- Auth Providers: N/A


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C02NLUQG0E5/p1641490125004800
- GitHub Issue Link: N/A
- Doc Update Link: N/A

## Summary
### Description of Customer Issue

The `repositoriesMatchingQuery` isn’t returning the same amount of repos as the same query in code search. Code Host returns 403 whilst trying to create drafts on Gitlab codehost.

### Troubleshooting Steps
- maybe adding count all would help?
- Please can you try searching for this same repos using the src-cli, I want to know if you are able to access this repos using the cli. I am trying to rule out permissions issue with the src-cli. The customer confirmed it worked.
- The customer solved this bit of the problem. "I was searching for a keyword in the query which would have matched in 26 files but then in my step I was doing a further filter on the keyword. Basically the keyword has a : in it which the matching query didn’t like but comby had no problem with finding"
- Key question I asked that helped solved the second issue was their SG version.
- we had some similar behaviour with draft on 3.34 . However, this was fixed in a newer version here.


### Resolution
- First issue : I was searching for a keyword in the query which would have matched in 26 files but then in my step I was doing a further filter on the keyword. Basically the keyword has a : in it which the matching query didn’t like but comby had no problem with finding

-  Second Issue: Upgrading the SG version to 3.35.1 fixed it.


### Relevant Docs Pages Used/Created

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->
```Failed to run operations on changeset
Creating commit from patch for repository "gitlab.com/xxxxx/xxxx/xxv/xxxxx": gitserver: pushing ref: exit status 128
$ git push --force https://git (https://git/):<redacted>@gitlab.com/xxxxx/xxxxx/nav/xxxx.git xxxxxxxxxxxx:refs/heads/feature/remove-resolved-environments
fatal: unable to access 'https://gitlab.com/xxxxx/xxxxx/nav/xxxxx.git/': The requested URL returned error: 403```


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5422.md -->
