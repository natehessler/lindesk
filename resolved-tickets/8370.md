
# Sourcegraph migration from EC2 to EKS <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#8370](https://sourcegraph.zendesk.com/agent/tickets/8370)
- Application engineer: Kelvin Lee
- Customer: <!-- Redact if this contains personally identifying information -->
- Date: May 20, 2022

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: no info
- Deployment: maybe moving from docker-compose -> kubernetes ?
- External Services: no info
- Auth Providers: no info


## Links
<!-- Data for application engineer manual entry -->
- Slack Links: None
- GitHub Issue Link: None
- Doc Update Link: None

## Summary
### Customer Question
Customer seeks advice for migrating EBS (Elastic Block Store) volumes to PV (Persistent Volumes), as recommended by Sourcegraph. Customer is intending on moving from an EC2 (Elastic Compute Cloud) instance to a EKS (Elastic Kubernetes Service) cluster .

### Application Engineer Answer
No specific recommendations from Sourcegraph for this procedure. The entities mentioned are pretty much all just AWS (Amazon Web Services) type entities/objects/concepts, so we don't recommend anything specific from our side.

At best, we have a small portion in our [docs that mentions using EBS volumes](https://docs.sourcegraph.com/admin/deploy/docker-compose/aws#:~:text=(recommended)%20The%20most%20straightforward%20method%20to%20backup%20this%20data%20is%20to%20snapshot%20the%20entire%20/mnt/docker%2Ddata%20EBS%20disk%20on%20an%20automatic%2C%20scheduled%20basis.) for _backup_, but the documentation doesn't touch on any notion of migration.

Instead, Application Engineer took a guess that customer is intending on going from a docker-compose deployment to a kubernetes deployment. For data migration as recommended by Sourcegraph, the process would be as such:
- extract the postgres data from the docker-compose deploymeny by starting at [this](https://docs.sourcegraph.com/admin/deploy/docker-compose#back-up-sourcegraph-databases) section of the documentation, stopping right before entering the "Restoring Sourcegraph databases into an existing environment".
- then seed the kubernetese deployment starting from [here](https://docs.sourcegraph.com/admin/deploy/kubernetes/operations#restoring-sourcegraph-databases-into-an-existing-environment). 

### Relevant Docs Pages Used/Created
https://docs.sourcegraph.com/admin/deploy/docker-compose#back-up-sourcegraph-databases
https://docs.sourcegraph.com/admin/deploy/kubernetes/operations#restoring-sourcegraph-databases-into-an-existing-environment

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 8370.md -->
