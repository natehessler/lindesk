​
# Apple: Question about authN part for SRC tool <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#12674](https://sourcegraph.zendesk.com/agent/tickets/12674)
- Application engineer: Alex Jean-Baptiste
- Customer: Apple <!-- Redact if this contains personally identifying information -->
- Date: January 24, 2023

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 4.4.0 
- Deployment: Kubernetes
- External Services: OTHER
- Auth Providers: http-header
​
​
## Links
<!-- Data for application engineer manual entry -->
- Slack Links: https://sourcegraph.slack.com/archives/C01NKL6V7E2/p1674581294195659
- GitHub Issue Link: N/A
- Doc Update Link: N/A
​
## Summary
### Customer Question
​
​
​I got `invalid character '<' looking for beginning of value` with the below cmd 
``` 
export SRC_ENDPOINT=https://ac-code.swe.apple.com 
export SRC_ACCESS_TOKEN={} 
src api -query='query { currentUser { username } }' 
``` 
I got empty return with this one: 
``` 
curl \ 
-H 'Authorization: token 913e05ebf2xxxxxx3b363525e5e46f' \ 
-d '{"query":"query { currentUser { username } }"}' \ 
https://ac-code.swe.apple.com/.api/graphql 
``` 
when I tried to use postman to send the above CURL request, the html IDMS login page got returned.

I found the doc to add additional headers, https://docs.sourcegraph.com/cli/explanations/env#adding-request-headers-with-src-header 
could you help advise if this is the right way to solve my issue? how can I do so with our auth method? Thanks!

We are using the below auth method. 
``` 
"auth.providers": [ 
{ 
"emailHeader": "X-AppleConnect-EmailAddress", 
"type": "http-header", 
"usernameHeader": "X-AppleConnect-AccountName" 
} 
], 
```

### Application Engineer Answer
​
​After looking closer at the docs shared here it would seem that this might be the right approach to solving this issue.
​
​
Mengchen Gao

Yesterday 18:17
x➜ ~ export SRCHEADERAUTHORIZATION=“Bearer xxxx”
➜ ~ export SRC_ENDPOINT=▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
➜ ~ src api -query=‘query { currentUser { username } }’
{

“data”: {
“currentUser”: {
“username”: “mengchen_gao”
}

}
}

I changed to use Bearer token I got from our IDMS server, this way works

### Relevant Docs Pages Used/Created
​https://docs.sourcegraph.com/cli/explanations/env#adding-request-headers-with-src-header

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 12674.md -->
