# Batch Changes Access Tokens <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#5452](https://sourcegraph.zendesk.com/agent/tickets/5452)
- Application engineer: Gabe Torres
- Customer: Sourcegraph <!-- Redact if this contains personally identifying information -->
- Date: Jan 7

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: ​
- Deployment:
- External Services:
- Auth Providers:


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:
- GitHub Issue Link:
- Doc Update Link:

## Summary
### Customer Question
I see in settings, that you need to set up another access token from GitHub. Is it because the existing token doesn't have enough permissions?
Batch Changes needs permission to publish changesets on your behalf. To grant permission, you will need to add a personal access token for each code host you’ll be publishing changesets on.You will only have to do this once. You can also set up a global account token so it's usable by all users of the Sourcegraph instance who have not added their own personal access tokens for Batch Changes.
Sourcegraph also uses the global service account to track existing changesets and keep changesets up to date. If no global service account token is set, we can currently fall back to the token configured for the code host connection. However, this fallback will be deprecated in the future, so for this reason we highly recommend setting up a global service account.

If we set up a Global Access token for Batch Changes and as a user I don't have access to certain repos, will it allow me to make these changes as part of a batch change or not?
It's complicated.The permissions that will be enforced when creating and updating changesets will be those of the service account, not the user. So, yes, if the batch change includes a repo that the user doesn't have access to, then the service account can create and modify PRs/MRs there.That said, the initial search that takes place to create the list of repos that are affected by the batch change does take place as the user. So if their search query matches a repo they don't have permission to access, it won't be included in the search results, and (by extension) the repo won't be in the batch change.So there are really two scenarios where a user could end up creating/updating things in repos they don't have access to:
They created a batch change while they had access to a repo, then lost access, then updated the batch change. That would still update the PR in the repo, assuming the service account has access.
They explicitly included a repo they don't have access to using the repository: field in the batch spec.

In general, I think we'd probably advise customers who make significant use of repo permissions against using service accounts for batch changes, basically for this reason.

### Relevant Docs Pages Used/Created
https://docs.sourcegraph.com/batch_changes/how-tos/configuring_credentials#global-service-account-tokens

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 5452.md -->
