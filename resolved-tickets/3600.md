# Precise code intel worker OOM 
 
- **Zendesk Link:** [#3600](https://sourcegraph.zendesk.com/agent/tickets/3600)
- **CSE:** Gabe Torres
- **Customer:** Reddit <!-- Redact if this contains personally identifying information -->

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->
 
## Technical Environment
- **Version:** 3.32
- **Deployment:** Kubernetes
- **External Services:** NA
- **Auth Providers:** NA
 
 
## Links
<!-- Data for CSE manual entry -->
- **Slack Links:** https://sourcegraph.slack.com/archives/C02BJ8T258D/p1632946463121900
- **GitHub Issue Link:** NA
- **Doc Update Link:** NA
 
## Summary
### Description of Customer Issue:  
The customer was trying to upload an LSIF using src lsif upload and received an error: Upload failed to complete: Failed to process
### Troubleshooting Steps: 
The customer noticed that the precise-code-intel-worker pod was OOM'ing. These were the settings for that deployment.
```
resources:
          limits:
            cpu: "2"
            memory: 4G
          requests:
            cpu: "1"
            memory: 4G
```
 
### Resolution:  
The customer increased the resources for the precise code interl worker deployment and they were able to process the LSIF upload.
https://github.com/sourcegraph/deploy-sourcegraph/blob/master/base/precise-code-intel/worker.Deployment.yaml 
Currently we do not have recommendations about horizontal scaling and resource allocation for the code intel service. We can use the settings for sourcegraph.com for reference: 
```
Our Sourcegraph.com deployment has the memory requests set to 32Gi, and 2CPU each
It also has a replica count of 4, compared to to 2 for deploy-sourcegraph (the worker is horizontally scalable)
```
Some more info from code intel: https://sourcegraph.slack.com/archives/CHXHX7XAS/p1633032236144100
 
### Relevant Error / Logs:  
<!-- Please redact keys, tokens, and personal identifying information -->
Upload failed to complete: Failed to process
 

<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 3600.md -->
