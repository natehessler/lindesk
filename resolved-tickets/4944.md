
# Twitter - lsif not processing monorepo, indexer not indexing <!-- Ticket Title  Hint: include keywords to make it searchable -->

- Zendesk Link: [#4944](https://sourcegraph.zendesk.com/agent/tickets/4944)
- Application engineer: Warren Gifford
- Customer: Twitter <!-- Redact if this contains personally identifying information -->
- Date: December 7, 2021

<!-- Data populated from integration, speak to Ben Gordon or Michael Bali if not working -->
<!-- During Internal team trial, fill missing data manually (we are waiting for all data to sync) -->

## Technical Environment
- Version: 3.35.1​
- Deployment: kubernetes
- External Services:
- Auth Providers:


## Links
<!-- Data for application engineer manual entry -->
- Slack Links:
- GitHub Issue Link: [https://github.com/sourcegraph/customer/issues/586](https://github.com/sourcegraph/customer/issues/586)
- Doc Update Link:

## Summary
### Description of Customer Issue
Twitter's monorepo began to fail to index. This first manifested as the lsif CI pipeline starting to fail. The zoekt index became out of date.

### Troubleshooting Steps
Check logs for the indexserver

### Resolution
This issue was resolved by the allocation of more resources to the gitserver as well as the implementation of many improvements to git (the .gitconfig) in both gitserver and zoekt-indexserver. These additions were primarily integrated into Sourcegraph main, but one environment variable was used to eliminate egress throttling SRC_GIT_SERVICE_MAX_EGRESS_BYTES_PER_SECOND

### Relevant Docs Pages Used/Created
[https://github.com/sourcegraph/sourcegraph/pull/28743](https://github.com/sourcegraph/sourcegraph/pull/28743)

### Relevant Error / Logs
<!-- Please redact keys, tokens, and personal identifying information -->
Upload failed to complete: Gitserver.DefaultBranchContains: BranchesContaining: gitserver.Command: signal: killed

```
2021/12/09 19:20:50 error indexing 27 git.twitter.biz/source@HEAD=a7017065a8429c5d0f95ac89b6e127e6cc2bb9a4,=a7017065a8429c5d0f95ac89b6e127e6cc2bb9a4: command [git -C /data/index/.indexserver.tmp/tmpfriend-8-259430004/git.twitter.biz%2Fsource.git -c protocol.version=2 fetch --depth=1 http://sourcegraph-frontend-internal/.internal/git/git.twitter.biz/source a7017065a8429c5d0f95ac89b6e127e6cc2bb9a4 a7017065a8429c5d0f95ac89b6e127e6cc2bb9a4] failed: exit status 128
OUT: warning: redirecting to http://gitserver-prod-0.gitserver:3178/git/git.twitter.biz/source/
fatal: remote-curl: bad line length character:
err
fatal: the remote end hung up unexpectedly
```


<!-- Once complete, upload a copy to https://github.com/sourcegraph/support-tools-internal/tree/main/resolved-tickets as a .md file -->
<!-- Name the file 4944.md -->
